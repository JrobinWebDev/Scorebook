/*!
 * Scorebook v0.2.24.
 *
 * Copyright (C) 2013 Ryan Smith.
 * This work is licenced under a Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported licence.
 * http://creativecommons.org/licenses/by-nc-sa/3.0/
 *
 * Date: 2013.1.12.
 */
var Scorebook=function(e){"use strict";function n(e){return typeof e=="number"&&Math.floor(e)===e?e||0:0}function r(e){return e===!0||e===!1?e||!1:!1}function i(e){return Object.prototype.toString.call(e)==="[object Date]"?isNaN(e.getTime())?null:e:null}function s(e){return t.innings.push({id:t.innings.length,battingTeam:e}),!0}function o(e){return t.overs.push({inningId:t.innings.length-1,id:t.overs.length,bowlerId:e}),!0}function u(e,s,o,u,a,f,l,c,h,p,d,v,m,g){return s=n(s),c=n(c),h=n(h),p=n(p),d=n(d),v=n(v),m=n(m),l=r(l),o=r(o),u=r(u),a=r(a),f=r(f),g=i(g),e=e||(t.overs[t.overs.length-1].id===t.balls[t.balls.length-1].overId?t.balls[t.balls.length-1].batsmanId:null),t.balls.push({overId:t.overs.length-1,id:t.balls.length,batsmanId:e,runs:s,wideBall:o,noBall:u,byes:a,legByes:f,wicketId:l===!0?t.wickets.length-1:null,wagonX:c,wagonY:h,pitchX:p,pitchY:d,batPen:v,bwlPen:m,dateTime:g}),!0}function a(e,n,r){var i=(t.wickets.length>0&&t.balls.length>0?t.wickets[t.wickets.length-1].ballId!==t.balls.length:!0)==0?!1:/^(bowled|lbw|handled the ball|hit wicket|hit the ball twice)$/.test(n)?"bowler":/^(caught|stumped)$/.test(n)?"both":/^(runout)$/.test(n)?"fielder":/^(obstruction|timed out)$/.test(n)?"none":!1,s=i==="bowler"||i==="both"?t.overs[t.overs.length-1].bowlerId||null:null;return r=i==="fielder"||i==="both"?r||null:null,i!==!1&&t.wickets.push({ballId:t.balls.length,id:t.wickets.length,batsmanId:e,bowlerId:s,fielderId:r,howOut:n}),i!==!1}function f(){var e=t.innings.length!==t.overs[t.overs.length-1].inningId+1?t.innings:t.overs.length!==t.balls[t.balls.length-1].overId+1?t.overs:t.balls[t.balls.length-1].wicketId===null?t.balls:t.wickets;return e===t.wickets&&(t.balls[t.balls.length-1].wicketId=null),e.pop(),!0}function l(e,t,n){var r,i=!0,n=n||Object.keys(t);for(r=0;r<n.length&&i===!0;r+=1)e[n[r]]!==t[n[r]]&&(i=!1);return i}function c(e){var n,r,i,s=[];if(e?e.id:!1)(!e.battingTeam||e.battingTeam===t.innings[e.id].battingTeam)&&s.push(t.innings[e.id]);else{n=t.innings.length,i=e?Object.keys(e):[];for(r=0;r<n;r+=1)l(t.innings[r],e,i)&&s.push(t.innings[r])}return s}function h(e,n){var r,i,s,o=[];if(n?n.id:!1)l(t.innings[t.overs[n.id].inningId],e,null)&&o.push(t.overs[n.id]);else{r=t.overs.length,s=n?Object.keys(n):[];for(i=0;i<r;i+=1)l(t.overs[i],n,s)&&o.push(t.overs[i])}return o}function p(e,n,r){var i,s,o,u,a,f=[],c=h(e,n);if(r?r.id:!1)c[0].id===t.balls[r.id].overId&&f.push(t.balls[r.id]);else{i=t.balls.length,s=c.length,o=r?Object.keys(r):[];for(u=0;u<i;u+=1)if(l(t.balls[u],r,o))for(a=0;a<s;a+=1)if(c[a].id===t.balls[u].overId){f.push(t.balls[u]);break}}return f}function d(e,n,r,i){var s,o,u,a,f,c=[],h=p(e,n,r);if(i?i.id:!1)h[0].id===t.wickets[i.id].ballId&&c.push(t.wickets[i.id]);else{s=t.wickets.length,o=h.length,u=i?Object.keys(i):[];for(a=0;a<s;a+=1)if(l(t.wickets[a],i,u))for(f=0;f<o;f+=1)if(h[f].id===t.wickets[a].ballId){c.push(t.wickets[a]);break}}return c}var t=e;return t=t||{},t.innings=t.innings||[],t.overs=t.overs||[],t.balls=t.balls||[],t.wickets=t.wickets||[],{addInnings:s,addOver:o,addBall:u,addWicket:a,undo:f,getInnings:c,getOvers:h,getBalls:p,getWickets:d,data:t}};